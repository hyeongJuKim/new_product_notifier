# 파이썬으로 웹크롤링(1)



## 왜?

**Python입문용**으로 쉽게 할 수 있는 웹크롤링을 해봤다.
내가 자주 방문하는 구제쇼핑몰에서 내가 **원하는 상품**을 **알림**받고 싶었다.
사이즈 250짜리 신발 새 제품이 나올 때 마다 **텔레그램 메신져의 봇**이 나에게 **메세지**를 보낸다.

## 개발환경 및 Library

#### 개발환경

- 개발환경 : MacOS El Capitan Laptop
- 운영환경 : CentOS release 6.8
- 언어 : Python3
- 개발 툴
  - IDE - Pycharm
  - Text Editor - SublimeText2
  - Note(MarkDown) - Typora
  - Brainstorming - mindmeister



##### 라이브러리

- Python pip
  - Beautiful Soup4
  - Telepot
- Telegram Messenger
  - Telegram Bot



### 사용기술?

- Linux cronTab

  ​

## 시나리오
- 파이썬 코드 작성
  - 원하는 URL을 HTML로 파싱
  - 신상품이 있거나, 신상품이 있지만 품절인 상품이 없는 경우만 다음으로 진행
  - 상품 목록 중 신상품만 Filter
  - 신상품 중 Sold Out이 아닌 것만 Filter
  - 상품의 이미지와 URL을 Telepot을 통해 TeleBot에게 전송
- 텔레그램 메신저에서 제공해주는 TeleBot이 나에게 메세지 전송
- Linux Crontab으로 Python Code를 매일 12시 6시 예약.





## 개발

가장 먼저 개발 환경부터 구성했다.  
나는 MacOS 사용자 이기 때문에 터미널에서 Python3, pip, Beautiful Soup4, Telepot을 설치했다.  
개발환경 끝!  

그 다음으로 알림받을 메신져 텔레그램을 맥북, 아이패드, 아이폰에 모두 설치했다.  

**텔레그램 Bot 받기**  
텔레그램 봇은 @BotFather 봇을 채팅 목록에 추가 후 받을 수 있다.  
딱 이미지만 봐도 봇을 주게 생겼다..;  

**Python Code 짜기**  
이제 바로 Python Code를 짜기만 하면된다.  
후..  
항상 셋팅까지 다 하고 코드를 짜려는 순간이 가장 귀찮다...  
..  
..  



**반복 예약설정**
Linux의 Crontab을 통해 반복 예약 작업을 해주면 된다.
사용 방법은 간단하다.  

**예외처리**
이놈이 잘 돌아가고 있는지 프로그램에서 Exception이 생겼는지 항상 모니터링 할 수 없기 때문에 이 프로그램을 전체를 예외처리 한 후 실패 할 경우 실패한 Exception을 메시지로 받도록 처리했다.  


## 느낀점

- 언제나 늘 그렇지만 말로는 쉬워도 해보면 막상 그렇지 않다.
- 코드를 짜는 것 뿐만 아니라 프로그램의 시나리오를 구성하는것도 충분한 생각을 한 후에 실행하는것이 좋다.
- 리펙토링 해야겠다.
- 리펙토링이 끝나면 동적으로 다시 하나 설계해보자


## 추가기능, 개선해야 사항

- Ver 1.0에서의 NewItemBot은 일방적으로 자료를 보내주는 방식.
  봇에게 명령을 해서 프로그램의 시작, 종료 등을 할 수 있도록 추가적인 기능이 필요하다.
- 봇에게 메세지를 보내서 가장 최근 상품 값을 입력 할 수 있도록 개선이 필요하다.
- 파이썬 프로그램이 Exception 발생으로 종료가 된다면 그 즉시 예외처리를 통해 메시지로 전송을 받을 수 있도록 개선이 필요하다.



